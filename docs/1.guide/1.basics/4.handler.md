---
icon: mdi:function
---

# äº‹ä»¶å¤„ç†å™¨

> äº‹ä»¶å¤„ç†å™¨æ˜¯ä¸€ä¸ªæŽ¥æ”¶ H3Event å¹¶è¿”å›žå“åº”çš„å‡½æ•°ã€‚

ä½ å¯ä»¥ä½¿ç”¨ `defineHandler` å®šä¹‰å¸¦ç±»åž‹çš„äº‹ä»¶å¤„ç†å™¨ã€‚

```js
import { H3, defineHandler } from "h3";

const app = new H3();

const handler = defineHandler((event) => "Response");

app.get("/", handler);
```

> [!NOTE]
> ä½¿ç”¨ `defineHandler` æ˜¯å¯é€‰çš„ã€‚
> ä½ ä¹Ÿå¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ªæŽ¥å— [`H3Event`](/guide/api/h3event) å¹¶è¿”å›žå“åº”çš„å‡½æ•°ã€‚

å›žè°ƒå‡½æ•°å¯ä»¥æ˜¯åŒæ­¥çš„ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼š

```js
defineHandler(async (event) => "Response");
```

## å¯¹è±¡è¯­æ³•

### middleware

ä½ å¯ä»¥é€‰æ‹©æ€§åœ°æ³¨å†Œä¸€äº› [ä¸­é—´ä»¶](/guide/basics/middleware) æ¥ä¸Žäº‹ä»¶å¤„ç†å™¨ä¸€èµ·è¿è¡Œï¼Œä»¥æ‹¦æˆªè¯·æ±‚ã€å“åº”æˆ–é”™è¯¯ã€‚

```js
import { basicAuth } from "h3";

defineHandler({
  middleware: [basicAuth({ password: "test" })],
  handler: (event) => "Hi!",
});
```

:read-more{to="/guide/basics/response" title="å“åº”å¤„ç†"}

:read-more{to="/guide/api/h3event" }

### meta

ä½ å¯ä»¥å®šä¹‰å¯é€‰çš„è·¯ç”±å…ƒæ•°æ®é™„åŠ åˆ°å¤„ç†å™¨ä¸Šï¼Œå¹¶ä»Žä»»ä½•å…¶ä»–ä¸­é—´ä»¶ä¸­è®¿é—®å®ƒä»¬ã€‚

```js
import { H3, defineHandler } from "h3";

const app = new H3();

app.use((event) => {
  console.log(event.context.matchedRoute?.meta); // { tag: "admin" }
});

app.get("/admin/**", defineHandler({
  meta: { tag: "admin" },
  handler: (event) => "Hi!",
})
```

::read-more{to="/guide/basics/routing#route-meta"}
æ³¨å†Œåˆ°åº”ç”¨å®žä¾‹æ—¶ä¹Ÿå¯ä»¥æ·»åŠ è·¯ç”±å…ƒæ•°æ®ã€‚
::

## å¤„ç†å™¨ `.fetch`

ç”¨ `defineHandler` å®šä¹‰çš„äº‹ä»¶å¤„ç†å™¨ï¼Œå¯ä»¥ä½œä¸º Web å¤„ç†å™¨ä½¿ç”¨ï¼Œç”šè‡³ä¸éœ€è¦ä½¿ç”¨ [H3](/guide/api/h3) ç±»ã€‚

```js
const handler = defineHandler(async (event) => `Request: ${event.req.url}`);

const response = await handler.fetch("http://localhost/");
console.log(response, await response.text());
```

## å»¶è¿Ÿå¤„ç†å™¨

ä½ å¯ä»¥ä½¿ç”¨ `defineLazyEventHandler` å®šä¹‰å»¶è¿Ÿäº‹ä»¶å¤„ç†å™¨ã€‚è¿™å…è®¸ä½ å®šä¹‰ä¸€äº›ä»…åœ¨ç¬¬ä¸€æ¬¡æ”¶åˆ°åŒ¹é…è·¯ç”±è¯·æ±‚æ—¶æ‰§è¡Œä¸€æ¬¡çš„ä¸€æ¬¡æ€§é€»è¾‘ã€‚

å»¶è¿Ÿäº‹ä»¶å¤„ç†å™¨å¿…é¡»è¿”å›žä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ã€‚

```js
import { defineLazyEventHandler } from "h3";

defineLazyEventHandler(async () => {
  await initSomething(); // åªä¼šæ‰§è¡Œä¸€æ¬¡
  return (event) => {
    return "Response";
  };
});
```

è¿™å¯¹äºŽå®šä¹‰ä¸€äº›ä¸€æ¬¡æ€§é€»è¾‘éžå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚é…ç½®ã€ç±»åˆå§‹åŒ–ã€ç¹é‡çš„è®¡ç®—ç­‰ã€‚

å¦ä¸€ä¸ªç”¨ä¾‹æ˜¯å»¶è¿ŸåŠ è½½è·¯ç”±ä»£ç å—ï¼š

```js [app.mjs]
import { H3, defineLazyEventHandler } from "h3";

const app = new H3();

app.all(
  "/route",
  defineLazyEventHandler(() =>
    import("./route.mjs").then((mod) => mod.default),
  ),
);
```

```js [route.mjs]
import { defineHandler } from "h3";

export default defineHandler((event) => "Hello!");
```

## è½¬æ¢ä¸ºå¤„ç†å™¨

æœ‰äº›æƒ…å†µä¸‹ä½ å¯èƒ½æƒ³å°†ä¸º Node.js æˆ–å…¶ä»–æ¡†æž¶åˆ¶ä½œçš„äº‹ä»¶å¤„ç†å™¨æˆ–å·¥å…·è½¬æ¢ä¸º H3ã€‚
å†…ç½®äº†ç›¸åº”çš„å·¥å…·å‡½æ•°æ¥å®žçŽ°æ­¤åŠŸèƒ½ã€‚

### ä»Ž Web å¤„ç†å™¨

å…·æœ‰ [Request](https://developer.mozilla.org/en-US/docs/Web/API/Request) => [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response) ç­¾åçš„è¯·æ±‚å¤„ç†å™¨ï¼Œå¯ä»¥ä½¿ç”¨ `fromWebHandler` å·¥å…·æˆ– [H3.mount](/guide/api/h3#h3mount) è½¬æ¢æˆ H3 äº‹ä»¶å¤„ç†å™¨ã€‚

```js
import { H3, fromWebHandler } from "h3";

export const app = new H3();

const webHandler = (request) => new Response("ðŸ‘‹ Hello!"));

// ä½¿ç”¨ fromWebHandler å·¥å…·
app.all("/web", fromWebHandler(webHandler));

// ä½¿ç”¨ç®€å•å°è£…
app.all("/web", event => webHandler(event.req));

// ä½¿ç”¨ app.mount
app.mount("/web", webHandler)
```

### ä»Ž Node.js å¤„ç†å™¨

å¦‚æžœä½ æœ‰ä¸€ä¸ªä½¿ç”¨ `(req, res) => {}` è¯­æ³•çš„ä¼ ç»Ÿ Node.js è¯·æ±‚å¤„ç†å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ `fromNodeHandler` å°†å…¶è½¬æ¢ä¸º h3 äº‹ä»¶å¤„ç†å™¨ã€‚

> [!IMPORTANT]
> Node.js äº‹ä»¶å¤„ç†å™¨åªèƒ½åœ¨ Node.js æœåŠ¡å™¨è¿è¡Œæ—¶æ‰§è¡Œï¼

```js
import { H3, fromNodeHandler } from "h3";

// å¼ºåˆ¶ä½¿ç”¨ Node.js å…¼å®¹ï¼ˆä¹Ÿé€‚ç”¨äºŽ Bun å’Œ Denoï¼‰
import { serve } from "h3/node";

export const app = new H3();

const nodeHandler = (req, res) => {
  res.end("Node handlers work!");
};

app.get("/web", fromNodeHandler(nodeHandler));
```