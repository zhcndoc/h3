[{"data":1,"prerenderedAt":768},["ShallowReactive",2],{"navigation":3,"-examples-serve-static-assets":185,"-examples-serve-static-assets-surround":763},[4,91,133,161,168],{"title":5,"path":6,"stem":7,"children":8,"icon":90},"Guide","/guide","1.guide/0.index",[9,12,53,69],{"title":10,"path":6,"stem":7,"icon":11},"入门指南","pixel:play",{"title":5,"icon":13,"path":14,"stem":15,"children":16,"page":52},"ph:book-open-duotone","/guide/basics","1.guide/1.basics",[17,22,27,32,37,42,47],{"title":18,"path":19,"stem":20,"icon":21},"请求生命周期","/guide/basics/lifecycle","1.guide/1.basics/1.lifecycle","icon-park-outline:handle-round",{"title":23,"path":24,"stem":25,"icon":26},"路由","/guide/basics/routing","1.guide/1.basics/2.routing","solar:routing-bold",{"title":28,"path":29,"stem":30,"icon":31},"中间件","/guide/basics/middleware","1.guide/1.basics/3.middleware","mdi:middleware-outline",{"title":33,"path":34,"stem":35,"icon":36},"事件处理器","/guide/basics/handler","1.guide/1.basics/4.handler","mdi:function",{"title":38,"path":39,"stem":40,"icon":41},"发送响应","/guide/basics/response","1.guide/1.basics/5.response","tabler:json",{"title":43,"path":44,"stem":45,"icon":46},"错误处理","/guide/basics/error","1.guide/1.basics/6.error","tabler:error-404",{"title":48,"path":49,"stem":50,"icon":51},"嵌套应用","/guide/basics/nested-apps","1.guide/1.basics/7.nested-apps","material-symbols-light:layers-outline",false,{"title":54,"icon":55,"path":56,"stem":57,"children":58,"page":52},"API","material-symbols-light:api-rounded","/guide/api","1.guide/900.api",[59,64],{"title":60,"path":61,"stem":62,"icon":63},"H3","/guide/api/h3","1.guide/900.api/1.h3","material-symbols:bolt-rounded",{"title":65,"path":66,"stem":67,"icon":68},"H3Event","/guide/api/h3event","1.guide/900.api/2.h3event","material-symbols:data-object-rounded",{"title":70,"icon":71,"path":72,"stem":73,"children":74,"page":52},"Advanced","hugeicons:more-01","/guide/advanced","1.guide/901.advanced",[75,80,85],{"title":76,"path":77,"stem":78,"icon":79},"Plugins","/guide/advanced/plugins","1.guide/901.advanced/1.plugins","clarity:plugin-line",{"title":81,"path":82,"stem":83,"icon":84},"WebSockets","/guide/advanced/websocket","1.guide/901.advanced/2.websocket","hugeicons:live-streaming-02",{"title":86,"path":87,"stem":88,"icon":89},"每夜构建","/guide/advanced/nightly","1.guide/901.advanced/9.nightly","game-icons:barn-owl","i-ph:book-open-duotone",{"title":92,"path":93,"stem":94,"children":95,"icon":97},"H3 工具集","/utils","2.utils/0.index",[96,98,103,108,113,118,123,128],{"title":92,"path":93,"stem":94,"icon":97},"ph:function-bold",{"title":99,"path":100,"stem":101,"icon":102},"请求","/utils/request","2.utils/1.request","material-symbols-light:input",{"title":104,"path":105,"stem":106,"icon":107},"响应","/utils/response","2.utils/2.response","material-symbols-light:output",{"title":109,"path":110,"stem":111,"icon":112},"Cookie","/utils/cookie","2.utils/3.cookie","material-symbols:cookie-outline",{"title":114,"path":115,"stem":116,"icon":117},"安全","/utils/security","2.utils/4.security","wpf:key-security",{"title":119,"path":120,"stem":121,"icon":122},"代理","/utils/proxy","2.utils/5.proxy","arcticons:super-proxy",{"title":124,"path":125,"stem":126,"icon":127},"更多工具","/utils/more","2.utils/9.more","mingcute:plus-line",{"title":129,"path":130,"stem":131,"icon":132},"社区","/utils/community","2.utils/99.community","lets-icons:external",{"title":134,"path":135,"stem":136,"children":137,"icon":139},"示例","/examples","4.examples/0.index",[138,140,145,149,153,157],{"title":134,"path":135,"stem":136,"icon":139},"ph:code",{"title":141,"path":142,"stem":143,"icon":144},"Cookies","/examples/handle-cookie","4.examples/handle-cookie","ph:arrow-right",{"title":146,"path":147,"stem":148,"icon":144},"会话","/examples/handle-session","4.examples/handle-session",{"title":150,"path":151,"stem":152,"icon":144},"静态资源","/examples/serve-static-assets","4.examples/serve-static-assets",{"title":154,"path":155,"stem":156,"icon":144},"流式响应","/examples/stream-response","4.examples/stream-response",{"title":158,"path":159,"stem":160,"icon":144},"验证数据","/examples/validate-data","4.examples/validate-data",{"title":162,"path":163,"stem":164,"children":165,"icon":167},"从 v1 到 v2 的迁移指南","/migration","5.migration/0.index",[166],{"title":162,"path":163,"stem":164,"icon":167},"icons8:up-round",{"title":169,"path":170,"stem":171,"children":172,"page":-1},"Blog","/blog","99.blog",[173,177,181],{"title":174,"path":170,"stem":175,"icon":176},"博客","99.blog/index","i-lucide-file-text",{"title":178,"path":179,"stem":180,"icon":176},"H3 1.8 - 迈向 Web 的边缘","/blog/v1.8","99.blog/1.v1.8",{"title":182,"path":183,"stem":184,"icon":176},"H3 v2 测试版","/blog/v2-beta","99.blog/2.v2-beta",{"id":186,"title":150,"body":187,"description":757,"extension":758,"meta":759,"navigation":760,"path":151,"seo":761,"stem":152,"__hash__":762},"content/4.examples/serve-static-assets.md",{"type":188,"value":189,"toc":754,"icon":144},"minimark",[190,194,202,381,392,419,430,434,452,460,728,743,750],[191,192,193],"p",{},"H3 可以提供静态资源，例如 HTML、图片、CSS、JavaScript 等。",[191,195,196,197,201],{},"要提供一个静态目录，你可以使用 ",[198,199,200],"code",{},"serveStatic"," 工具。",[203,204,209],"pre",{"className":205,"code":206,"language":207,"meta":208,"style":208},"language-ts shiki shiki-themes github-light github-dark github-dark","import { H3, serveStatic } from \"h3\";\n\nconst app = new H3();\n\napp.use(\"/public/**\", (event) => {\n  return serveStatic(event, {\n    getContents: (id) => {\n      // TODO\n    },\n    getMeta: (id) => {\n      // TODO\n    },\n  });\n});\n","ts","",[198,210,211,234,241,264,269,300,312,330,337,343,359,364,369,375],{"__ignoreMap":208},[212,213,216,220,224,227,231],"span",{"class":214,"line":215},"line",1,[212,217,219],{"class":218},"so5gQ","import",[212,221,223],{"class":222},"slsVL"," { H3, serveStatic } ",[212,225,226],{"class":218},"from",[212,228,230],{"class":229},"sfrk1"," \"h3\"",[212,232,233],{"class":222},";\n",[212,235,237],{"class":214,"line":236},2,[212,238,240],{"emptyLinePlaceholder":239},true,"\n",[212,242,244,247,251,254,257,261],{"class":214,"line":243},3,[212,245,246],{"class":218},"const",[212,248,250],{"class":249},"suiK_"," app",[212,252,253],{"class":218}," =",[212,255,256],{"class":218}," new",[212,258,260],{"class":259},"shcOC"," H3",[212,262,263],{"class":222},"();\n",[212,265,267],{"class":214,"line":266},4,[212,268,240],{"emptyLinePlaceholder":239},[212,270,272,275,278,281,284,287,291,294,297],{"class":214,"line":271},5,[212,273,274],{"class":222},"app.",[212,276,277],{"class":259},"use",[212,279,280],{"class":222},"(",[212,282,283],{"class":229},"\"/public/**\"",[212,285,286],{"class":222},", (",[212,288,290],{"class":289},"sQHwn","event",[212,292,293],{"class":222},") ",[212,295,296],{"class":218},"=>",[212,298,299],{"class":222}," {\n",[212,301,303,306,309],{"class":214,"line":302},6,[212,304,305],{"class":218},"  return",[212,307,308],{"class":259}," serveStatic",[212,310,311],{"class":222},"(event, {\n",[212,313,315,318,321,324,326,328],{"class":214,"line":314},7,[212,316,317],{"class":259},"    getContents",[212,319,320],{"class":222},": (",[212,322,323],{"class":289},"id",[212,325,293],{"class":222},[212,327,296],{"class":218},[212,329,299],{"class":222},[212,331,333],{"class":214,"line":332},8,[212,334,336],{"class":335},"sCsY4","      // TODO\n",[212,338,340],{"class":214,"line":339},9,[212,341,342],{"class":222},"    },\n",[212,344,346,349,351,353,355,357],{"class":214,"line":345},10,[212,347,348],{"class":259},"    getMeta",[212,350,320],{"class":222},[212,352,323],{"class":289},[212,354,293],{"class":222},[212,356,296],{"class":218},[212,358,299],{"class":222},[212,360,362],{"class":214,"line":361},11,[212,363,336],{"class":335},[212,365,367],{"class":214,"line":366},12,[212,368,342],{"class":222},[212,370,372],{"class":214,"line":371},13,[212,373,374],{"class":222},"  });\n",[212,376,378],{"class":214,"line":377},14,[212,379,380],{"class":222},"});\n",[191,382,383,384,387,388,391],{},"这段代码还未提供任何文件服务。你需要实现 ",[198,385,386],{},"getContents"," 和 ",[198,389,390],{},"getMeta"," 方法。",[393,394,395,409],"ul",{},[396,397,398,400,401,404,405,408],"li",{},[198,399,386],{}," 用于读取文件内容。它应该返回一个 ",[198,402,403],{},"Promise","，解析为文件内容，如果文件不存在则为 ",[198,406,407],{},"undefined","。",[396,410,411,413,414,416,417,408],{},[198,412,390],{}," 用于获取文件元信息。它应该返回一个 ",[198,415,403],{},"，解析为文件的元数据，如果文件不存在则为 ",[198,418,407],{},[191,420,421,422,425,426,429],{},"它们被分开是为了让 H3 可以在不读取文件内容的情况下响应 ",[198,423,424],{},"HEAD"," 请求，并使用 ",[198,427,428],{},"Last-Modified"," 头部。",[431,432,433],"h2",{"id":433},"读取文件",[191,435,436,437,440,441,444,445,451],{},"现在，在 ",[198,438,439],{},"public"," 目录中创建一个包含简单消息的 ",[198,442,443],{},"index.html"," 文件，并在浏览器中打开 ",[446,447,448],"a",{"href":448,"rel":449},"http://localhost:3000",[450],"nofollow"," 。你应该可以看到该消息。",[191,453,454,455,387,457,459],{},"接下来，我们可以实现 ",[198,456,386],{},[198,458,390],{}," 方法：",[203,461,463],{"className":205,"code":462,"language":207,"meta":208,"style":208},"import { stat, readFile } from \"node:fs/promises\";\nimport { join } from \"node:path\";\nimport { H3, serve, serveStatic } from \"h3\";\n\nconst app = new H3();\n\napp.use(\"/public/**\", (event) => {\n  return serveStatic(event, {\n    indexNames: [\"/index.html\"],\n    getContents: (id) => readFile(join(\"public\", id)),\n    getMeta: async (id) => {\n      const stats = await stat(join(\"public\", id)).catch(() => {});\n      if (stats?.isFile()) {\n        return {\n          size: stats.size,\n          mtime: stats.mtimeMs,\n        };\n      }\n    },\n  });\n});\n\nserve(app);\n",[198,464,465,479,493,506,510,524,528,548,556,567,595,616,654,668,675,681,687,693,699,704,709,714,719],{"__ignoreMap":208},[212,466,467,469,472,474,477],{"class":214,"line":215},[212,468,219],{"class":218},[212,470,471],{"class":222}," { stat, readFile } ",[212,473,226],{"class":218},[212,475,476],{"class":229}," \"node:fs/promises\"",[212,478,233],{"class":222},[212,480,481,483,486,488,491],{"class":214,"line":236},[212,482,219],{"class":218},[212,484,485],{"class":222}," { join } ",[212,487,226],{"class":218},[212,489,490],{"class":229}," \"node:path\"",[212,492,233],{"class":222},[212,494,495,497,500,502,504],{"class":214,"line":243},[212,496,219],{"class":218},[212,498,499],{"class":222}," { H3, serve, serveStatic } ",[212,501,226],{"class":218},[212,503,230],{"class":229},[212,505,233],{"class":222},[212,507,508],{"class":214,"line":266},[212,509,240],{"emptyLinePlaceholder":239},[212,511,512,514,516,518,520,522],{"class":214,"line":271},[212,513,246],{"class":218},[212,515,250],{"class":249},[212,517,253],{"class":218},[212,519,256],{"class":218},[212,521,260],{"class":259},[212,523,263],{"class":222},[212,525,526],{"class":214,"line":302},[212,527,240],{"emptyLinePlaceholder":239},[212,529,530,532,534,536,538,540,542,544,546],{"class":214,"line":314},[212,531,274],{"class":222},[212,533,277],{"class":259},[212,535,280],{"class":222},[212,537,283],{"class":229},[212,539,286],{"class":222},[212,541,290],{"class":289},[212,543,293],{"class":222},[212,545,296],{"class":218},[212,547,299],{"class":222},[212,549,550,552,554],{"class":214,"line":332},[212,551,305],{"class":218},[212,553,308],{"class":259},[212,555,311],{"class":222},[212,557,558,561,564],{"class":214,"line":339},[212,559,560],{"class":222},"    indexNames: [",[212,562,563],{"class":229},"\"/index.html\"",[212,565,566],{"class":222},"],\n",[212,568,569,571,573,575,577,579,582,584,587,589,592],{"class":214,"line":345},[212,570,317],{"class":259},[212,572,320],{"class":222},[212,574,323],{"class":289},[212,576,293],{"class":222},[212,578,296],{"class":218},[212,580,581],{"class":259}," readFile",[212,583,280],{"class":222},[212,585,586],{"class":259},"join",[212,588,280],{"class":222},[212,590,591],{"class":229},"\"public\"",[212,593,594],{"class":222},", id)),\n",[212,596,597,599,602,605,608,610,612,614],{"class":214,"line":361},[212,598,348],{"class":259},[212,600,601],{"class":222},": ",[212,603,604],{"class":218},"async",[212,606,607],{"class":222}," (",[212,609,323],{"class":289},[212,611,293],{"class":222},[212,613,296],{"class":218},[212,615,299],{"class":222},[212,617,618,621,624,626,629,632,634,636,638,640,643,646,649,651],{"class":214,"line":366},[212,619,620],{"class":218},"      const",[212,622,623],{"class":249}," stats",[212,625,253],{"class":218},[212,627,628],{"class":218}," await",[212,630,631],{"class":259}," stat",[212,633,280],{"class":222},[212,635,586],{"class":259},[212,637,280],{"class":222},[212,639,591],{"class":229},[212,641,642],{"class":222},", id)).",[212,644,645],{"class":259},"catch",[212,647,648],{"class":222},"(() ",[212,650,296],{"class":218},[212,652,653],{"class":222}," {});\n",[212,655,656,659,662,665],{"class":214,"line":371},[212,657,658],{"class":218},"      if",[212,660,661],{"class":222}," (stats?.",[212,663,664],{"class":259},"isFile",[212,666,667],{"class":222},"()) {\n",[212,669,670,673],{"class":214,"line":377},[212,671,672],{"class":218},"        return",[212,674,299],{"class":222},[212,676,678],{"class":214,"line":677},15,[212,679,680],{"class":222},"          size: stats.size,\n",[212,682,684],{"class":214,"line":683},16,[212,685,686],{"class":222},"          mtime: stats.mtimeMs,\n",[212,688,690],{"class":214,"line":689},17,[212,691,692],{"class":222},"        };\n",[212,694,696],{"class":214,"line":695},18,[212,697,698],{"class":222},"      }\n",[212,700,702],{"class":214,"line":701},19,[212,703,342],{"class":222},[212,705,707],{"class":214,"line":706},20,[212,708,374],{"class":222},[212,710,712],{"class":214,"line":711},21,[212,713,380],{"class":222},[212,715,717],{"class":214,"line":716},22,[212,718,240],{"emptyLinePlaceholder":239},[212,720,722,725],{"class":214,"line":721},23,[212,723,724],{"class":259},"serve",[212,726,727],{"class":222},"(app);\n",[191,729,730,732,733,735,736,739,740,742],{},[198,731,386],{}," 读取文件并返回其内容，非常简单。",[198,734,390],{}," 使用 ",[198,737,738],{},"fs.stat"," 获取文件元数据。如果文件不存在或不是文件，返回 ",[198,741,407],{},"。否则返回文件大小和最后修改时间。",[191,744,745,746,749],{},"文件大小和最后修改时间用于生成 etag，以便如果文件自上次请求以来没有被修改，则发送 ",[198,747,748],{},"304 Not Modified"," 响应。这对于避免发送未更改的文件非常有用。",[751,752,753],"style",{},"html pre.shiki code .so5gQ, html code.shiki .so5gQ{--shiki-light:#D73A49;--shiki-default:#F97583;--shiki-dark:#F97583}html pre.shiki code .slsVL, html code.shiki .slsVL{--shiki-light:#24292E;--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8}html pre.shiki code .sfrk1, html code.shiki .sfrk1{--shiki-light:#032F62;--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF}html pre.shiki code .suiK_, html code.shiki .suiK_{--shiki-light:#005CC5;--shiki-default:#79B8FF;--shiki-dark:#79B8FF}html pre.shiki code .shcOC, html code.shiki .shcOC{--shiki-light:#6F42C1;--shiki-default:#B392F0;--shiki-dark:#B392F0}html pre.shiki code .sQHwn, html code.shiki .sQHwn{--shiki-light:#E36209;--shiki-default:#FFAB70;--shiki-dark:#FFAB70}html pre.shiki code .sCsY4, html code.shiki .sCsY4{--shiki-light:#6A737D;--shiki-default:#6A737D;--shiki-dark:#6A737D}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":208,"searchDepth":236,"depth":236,"links":755},[756],{"id":433,"depth":236,"text":433},"提供静态资源服务，例如 HTML、图片、CSS、JavaScript 等。","md",{"icon":144},{"icon":144},{"title":150,"description":757},"i--iWcylkV-N7JPWWBGjFL-DbT-J09-iF09VkqPdKd0",[764,766],{"title":146,"path":147,"stem":148,"description":765,"icon":144,"children":-1},"通过会话记住您的用户。",{"title":154,"path":155,"stem":156,"description":767,"icon":144,"children":-1},"向客户端进行流式响应。",1757861511081]