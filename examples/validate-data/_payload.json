[{"data":1,"prerenderedAt":1955},["ShallowReactive",2],{"navigation":3,"-examples-validate-data":185,"-examples-validate-data-surround":1951},[4,91,133,161,168],{"title":5,"path":6,"stem":7,"children":8,"icon":90},"Guide","/guide","1.guide/0.index",[9,12,53,69],{"title":10,"path":6,"stem":7,"icon":11},"入门指南","pixel:play",{"title":5,"icon":13,"path":14,"stem":15,"children":16,"page":52},"ph:book-open-duotone","/guide/basics","1.guide/1.basics",[17,22,27,32,37,42,47],{"title":18,"path":19,"stem":20,"icon":21},"请求生命周期","/guide/basics/lifecycle","1.guide/1.basics/1.lifecycle","icon-park-outline:handle-round",{"title":23,"path":24,"stem":25,"icon":26},"路由","/guide/basics/routing","1.guide/1.basics/2.routing","solar:routing-bold",{"title":28,"path":29,"stem":30,"icon":31},"中间件","/guide/basics/middleware","1.guide/1.basics/3.middleware","mdi:middleware-outline",{"title":33,"path":34,"stem":35,"icon":36},"事件处理器","/guide/basics/handler","1.guide/1.basics/4.handler","mdi:function",{"title":38,"path":39,"stem":40,"icon":41},"发送响应","/guide/basics/response","1.guide/1.basics/5.response","tabler:json",{"title":43,"path":44,"stem":45,"icon":46},"错误处理","/guide/basics/error","1.guide/1.basics/6.error","tabler:error-404",{"title":48,"path":49,"stem":50,"icon":51},"嵌套应用","/guide/basics/nested-apps","1.guide/1.basics/7.nested-apps","material-symbols-light:layers-outline",false,{"title":54,"icon":55,"path":56,"stem":57,"children":58,"page":52},"API","material-symbols-light:api-rounded","/guide/api","1.guide/900.api",[59,64],{"title":60,"path":61,"stem":62,"icon":63},"H3","/guide/api/h3","1.guide/900.api/1.h3","material-symbols:bolt-rounded",{"title":65,"path":66,"stem":67,"icon":68},"H3Event","/guide/api/h3event","1.guide/900.api/2.h3event","material-symbols:data-object-rounded",{"title":70,"icon":71,"path":72,"stem":73,"children":74,"page":52},"Advanced","hugeicons:more-01","/guide/advanced","1.guide/901.advanced",[75,80,85],{"title":76,"path":77,"stem":78,"icon":79},"Plugins","/guide/advanced/plugins","1.guide/901.advanced/1.plugins","clarity:plugin-line",{"title":81,"path":82,"stem":83,"icon":84},"WebSockets","/guide/advanced/websocket","1.guide/901.advanced/2.websocket","hugeicons:live-streaming-02",{"title":86,"path":87,"stem":88,"icon":89},"每夜构建","/guide/advanced/nightly","1.guide/901.advanced/9.nightly","game-icons:barn-owl","i-ph:book-open-duotone",{"title":92,"path":93,"stem":94,"children":95,"icon":97},"H3 工具集","/utils","2.utils/0.index",[96,98,103,108,113,118,123,128],{"title":92,"path":93,"stem":94,"icon":97},"ph:function-bold",{"title":99,"path":100,"stem":101,"icon":102},"请求","/utils/request","2.utils/1.request","material-symbols-light:input",{"title":104,"path":105,"stem":106,"icon":107},"响应","/utils/response","2.utils/2.response","material-symbols-light:output",{"title":109,"path":110,"stem":111,"icon":112},"Cookie","/utils/cookie","2.utils/3.cookie","material-symbols:cookie-outline",{"title":114,"path":115,"stem":116,"icon":117},"安全","/utils/security","2.utils/4.security","wpf:key-security",{"title":119,"path":120,"stem":121,"icon":122},"代理","/utils/proxy","2.utils/5.proxy","arcticons:super-proxy",{"title":124,"path":125,"stem":126,"icon":127},"更多工具","/utils/more","2.utils/9.more","mingcute:plus-line",{"title":129,"path":130,"stem":131,"icon":132},"社区","/utils/community","2.utils/99.community","lets-icons:external",{"title":134,"path":135,"stem":136,"children":137,"icon":139},"示例","/examples","4.examples/0.index",[138,140,145,149,153,157],{"title":134,"path":135,"stem":136,"icon":139},"ph:code",{"title":141,"path":142,"stem":143,"icon":144},"Cookies","/examples/handle-cookie","4.examples/handle-cookie","ph:arrow-right",{"title":146,"path":147,"stem":148,"icon":144},"会话","/examples/handle-session","4.examples/handle-session",{"title":150,"path":151,"stem":152,"icon":144},"静态资源","/examples/serve-static-assets","4.examples/serve-static-assets",{"title":154,"path":155,"stem":156,"icon":144},"流式响应","/examples/stream-response","4.examples/stream-response",{"title":158,"path":159,"stem":160,"icon":144},"验证数据","/examples/validate-data","4.examples/validate-data",{"title":162,"path":163,"stem":164,"children":165,"icon":167},"从 v1 到 v2 的迁移指南","/migration","5.migration/0.index",[166],{"title":162,"path":163,"stem":164,"icon":167},"icons8:up-round",{"title":169,"path":170,"stem":171,"children":172},"Blog","/blog","99.blog",[173,177,181],{"title":174,"path":170,"stem":175,"icon":176},"博客","99.blog/index","i-lucide-file-text",{"title":178,"path":179,"stem":180,"icon":176},"H3 1.8 - 迈向 Web 的边缘","/blog/v1.8","99.blog/1.v1.8",{"title":182,"path":183,"stem":184,"icon":176},"H3 v2 测试版","/blog/v2-beta","99.blog/2.v2-beta",{"id":186,"title":158,"body":187,"description":1945,"extension":1946,"meta":1947,"navigation":1948,"path":159,"seo":1949,"stem":160,"__hash__":1950},"content/4.examples/validate-data.md",{"type":188,"value":189,"toc":1937,"icon":144},"minimark",[190,194,205,209,212,235,273,283,294,298,308,649,656,667,674,677,685,1061,1067,1073,1082,1086,1089,1096,1388,1391,1431,1434,1443,1447,1449,1462,1468,1692,1695,1933],[191,192,193],"p",{},"当您在服务器端接收到数据时，必须对其进行验证。所谓验证，是指接收的数据结构必须与预期结构相匹配。这很重要，因为您无法信任来自未知来源的数据，比如用户或外部 API。",[195,196,197],"warning",{},[191,198,199,200,204],{},"\n不要使用类型泛型来作为验证。为类似 ",[201,202,203],"code",{},"readBody"," 这样的工具提供接口并不是验证。您必须在使用数据之前进行验证。",[206,207,208],"h2",{"id":208},"验证辅助工具",[191,210,211],{},"H3 提供了一些辅助工具来帮助您处理数据验证。您将能够验证：",[213,214,215,223,229],"ul",{},[216,217,218,219,222],"li",{},"使用 ",[201,220,221],{},"getValidatedQuery"," 验证查询参数",[216,224,218,225,228],{},[201,226,227],{},"getValidatedRouterParams"," 验证路由参数",[216,230,218,231,234],{},[201,232,233],{},"readValidatedBody"," 验证请求体",[191,236,237,238,242,243,250,251,250,256,261,262,267,268,272],{},"H3 不提供任何验证库，但它支持来自",[239,240,241],"strong",{},"Standard-Schema"," 兼容库的 schema，比如：",[244,245,249],"a",{"href":246,"rel":247},"https://zod.dev",[248],"nofollow","Zod","、",[244,252,255],{"href":253,"rel":254},"https://valibot.dev",[248],"Valibot",[244,257,260],{"href":258,"rel":259},"https://arktype.io/",[248],"ArkType"," 等……（所有兼容库请查看",[244,263,266],{"href":264,"rel":265},"https://github.com/standard-schema/standard-schema",[248],"它们的官方仓库","）。如果您想使用一个不兼容 Standard-Schema 的验证库，您仍然可以使用，但必须使用该库自身提供的解析函数（请参阅下面的",[244,269,271],{"href":270},"#%E5%AE%89%E5%85%A8%E8%A7%A3%E6%9E%90","安全解析","部分）。",[195,274,275],{},[191,276,277,278,282],{},"\nH3 是运行时无关的。这意味着您可以在",[244,279,281],{"href":280},"/adapters","任何运行时","中使用它。但某些验证库并不兼容所有运行时。",[191,284,285,286,289,290,293],{},"下面让我们看看如何使用 ",[244,287,249],{"href":246,"rel":288},[248]," 和 ",[244,291,255],{"href":253,"rel":292},[248]," 进行数据验证。",[295,296,297],"h3",{"id":297},"验证路由参数",[191,299,300,301,303,304,307],{},"您可以使用 ",[201,302,227],{}," 来验证路由参数并获取结果，替代 ",[201,305,306],{},"getRouterParams","：",[309,310,315],"pre",{"className":311,"code":312,"language":313,"meta":314,"style":314},"language-js shiki shiki-themes github-light github-dark github-dark","import { getValidatedRouterParams } from \"h3\";\nimport * as z from \"zod\";\nimport * as v from \"valibot\";\n\n// 使用 Zod 示例\nconst contentSchema = z.object({\n  topic: z.string().min(1),\n  uuid: z.string().uuid(),\n});\n// 使用 Valibot 示例\nconst contentSchema = v.object({\n  topic: v.pipe(v.string(), v.nonEmpty()),\n  uuid: v.pipe(v.string(), v.uuid()),\n});\n\nrouter.use(\n  // 您必须使用一个路由以使用参数\n  \"/content/:topic/:uuid\",\n  async (event) => {\n    const params = await getValidatedRouterParams(event, contentSchema);\n    return `您正在查找 topic 为 \"${params.topic}\" 且 uuid 为 \"${params.uuid}\" 的内容。`;\n  },\n);\n","js","",[201,316,317,340,362,381,388,395,417,441,457,463,469,485,508,526,531,536,548,554,563,585,605,637,643],{"__ignoreMap":314},[318,319,322,326,330,333,337],"span",{"class":320,"line":321},"line",1,[318,323,325],{"class":324},"so5gQ","import",[318,327,329],{"class":328},"slsVL"," { getValidatedRouterParams } ",[318,331,332],{"class":324},"from",[318,334,336],{"class":335},"sfrk1"," \"h3\"",[318,338,339],{"class":328},";\n",[318,341,343,345,349,352,355,357,360],{"class":320,"line":342},2,[318,344,325],{"class":324},[318,346,348],{"class":347},"suiK_"," *",[318,350,351],{"class":324}," as",[318,353,354],{"class":328}," z ",[318,356,332],{"class":324},[318,358,359],{"class":335}," \"zod\"",[318,361,339],{"class":328},[318,363,365,367,369,371,374,376,379],{"class":320,"line":364},3,[318,366,325],{"class":324},[318,368,348],{"class":347},[318,370,351],{"class":324},[318,372,373],{"class":328}," v ",[318,375,332],{"class":324},[318,377,378],{"class":335}," \"valibot\"",[318,380,339],{"class":328},[318,382,384],{"class":320,"line":383},4,[318,385,387],{"emptyLinePlaceholder":386},true,"\n",[318,389,391],{"class":320,"line":390},5,[318,392,394],{"class":393},"sCsY4","// 使用 Zod 示例\n",[318,396,398,401,404,407,410,414],{"class":320,"line":397},6,[318,399,400],{"class":324},"const",[318,402,403],{"class":347}," contentSchema",[318,405,406],{"class":324}," =",[318,408,409],{"class":328}," z.",[318,411,413],{"class":412},"shcOC","object",[318,415,416],{"class":328},"({\n",[318,418,420,423,426,429,432,435,438],{"class":320,"line":419},7,[318,421,422],{"class":328},"  topic: z.",[318,424,425],{"class":412},"string",[318,427,428],{"class":328},"().",[318,430,431],{"class":412},"min",[318,433,434],{"class":328},"(",[318,436,437],{"class":347},"1",[318,439,440],{"class":328},"),\n",[318,442,444,447,449,451,454],{"class":320,"line":443},8,[318,445,446],{"class":328},"  uuid: z.",[318,448,425],{"class":412},[318,450,428],{"class":328},[318,452,453],{"class":412},"uuid",[318,455,456],{"class":328},"(),\n",[318,458,460],{"class":320,"line":459},9,[318,461,462],{"class":328},"});\n",[318,464,466],{"class":320,"line":465},10,[318,467,468],{"class":393},"// 使用 Valibot 示例\n",[318,470,472,474,476,478,481,483],{"class":320,"line":471},11,[318,473,400],{"class":324},[318,475,403],{"class":347},[318,477,406],{"class":324},[318,479,480],{"class":328}," v.",[318,482,413],{"class":412},[318,484,416],{"class":328},[318,486,488,491,494,497,499,502,505],{"class":320,"line":487},12,[318,489,490],{"class":328},"  topic: v.",[318,492,493],{"class":412},"pipe",[318,495,496],{"class":328},"(v.",[318,498,425],{"class":412},[318,500,501],{"class":328},"(), v.",[318,503,504],{"class":412},"nonEmpty",[318,506,507],{"class":328},"()),\n",[318,509,511,514,516,518,520,522,524],{"class":320,"line":510},13,[318,512,513],{"class":328},"  uuid: v.",[318,515,493],{"class":412},[318,517,496],{"class":328},[318,519,425],{"class":412},[318,521,501],{"class":328},[318,523,453],{"class":412},[318,525,507],{"class":328},[318,527,529],{"class":320,"line":528},14,[318,530,462],{"class":328},[318,532,534],{"class":320,"line":533},15,[318,535,387],{"emptyLinePlaceholder":386},[318,537,539,542,545],{"class":320,"line":538},16,[318,540,541],{"class":328},"router.",[318,543,544],{"class":412},"use",[318,546,547],{"class":328},"(\n",[318,549,551],{"class":320,"line":550},17,[318,552,553],{"class":393},"  // 您必须使用一个路由以使用参数\n",[318,555,557,560],{"class":320,"line":556},18,[318,558,559],{"class":335},"  \"/content/:topic/:uuid\"",[318,561,562],{"class":328},",\n",[318,564,566,569,572,576,579,582],{"class":320,"line":565},19,[318,567,568],{"class":324},"  async",[318,570,571],{"class":328}," (",[318,573,575],{"class":574},"sQHwn","event",[318,577,578],{"class":328},") ",[318,580,581],{"class":324},"=>",[318,583,584],{"class":328}," {\n",[318,586,588,591,594,596,599,602],{"class":320,"line":587},20,[318,589,590],{"class":324},"    const",[318,592,593],{"class":347}," params",[318,595,406],{"class":324},[318,597,598],{"class":324}," await",[318,600,601],{"class":412}," getValidatedRouterParams",[318,603,604],{"class":328},"(event, contentSchema);\n",[318,606,608,611,614,617,620,623,626,628,630,632,635],{"class":320,"line":607},21,[318,609,610],{"class":324},"    return",[318,612,613],{"class":335}," `您正在查找 topic 为 \"${",[318,615,616],{"class":328},"params",[318,618,619],{"class":335},".",[318,621,622],{"class":328},"topic",[318,624,625],{"class":335},"}\" 且 uuid 为 \"${",[318,627,616],{"class":328},[318,629,619],{"class":335},[318,631,453],{"class":328},[318,633,634],{"class":335},"}\" 的内容。`",[318,636,339],{"class":328},[318,638,640],{"class":320,"line":639},22,[318,641,642],{"class":328},"  },\n",[318,644,646],{"class":320,"line":645},23,[318,647,648],{"class":328},");\n",[191,650,651,652,655],{},"如果您向该事件处理程序发送一个有效请求，例如 ",[201,653,654],{},"/content/posts/123e4567-e89b-12d3-a456-426614174000","，您将得到如下响应：",[309,657,661],{"className":658,"code":659,"language":660,"meta":314,"style":314},"language-txt shiki shiki-themes github-light github-dark github-dark","您正在查找 topic 为 \"posts\" 且 uuid 为 \"123e4567-e89b-12d3-a456-426614174000\" 的内容。\n","txt",[201,662,663],{"__ignoreMap":314},[318,664,665],{"class":320,"line":321},[318,666,659],{},[191,668,669,670,673],{},"如果您发送了无效请求且验证失败，H3 将抛出 ",[201,671,672],{},"400 Validation Error"," 错误。在错误数据中，您会找到验证错误信息，可以在客户端使用它来向用户展示友好的错误提示。",[295,675,676],{"id":676},"验证查询参数",[191,678,300,679,681,682,307],{},[201,680,221],{}," 来验证查询参数并获取结果，替代 ",[201,683,684],{},"getQuery",[309,686,688],{"className":311,"code":687,"language":313,"meta":314,"style":314},"import { getValidatedQuery } from \"h3\";\nimport * as z from \"zod\";\nimport * as v from \"valibot\";\n\n// 使用 Zod 示例\nconst stringToNumber = z\n  .string()\n  .regex(/^\\d+$/, \"必须是数字字符串\")\n  .transform(Number);\nconst paginationSchema = z.object({\n  page: stringToNumber.optional().default(1),\n  size: stringToNumber.optional().default(10),\n});\n\n// 使用 Valibot 示例\nconst stringToNumber = v.pipe(\n  v.string(),\n  v.regex(/^\\d+$/, \"必须是数字字符串\"),\n  v.transform(Number),\n);\nconst paginationSchema = v.object({\n  page: v.optional(stringToNumber, 1),\n  size: v.optional(stringToNumber, 10),\n});\n\napp.use(async (event) => {\n  const query = await getValidatedQuery(event, paginationSchema);\n  return `您当前在第 ${query.page} 页，每页显示 ${query.size} 条内容。`;\n});\n",[201,689,690,703,719,735,739,743,755,765,797,807,822,841,859,863,867,871,885,894,918,927,931,945,959,972,977,982,1005,1024,1056],{"__ignoreMap":314},[318,691,692,694,697,699,701],{"class":320,"line":321},[318,693,325],{"class":324},[318,695,696],{"class":328}," { getValidatedQuery } ",[318,698,332],{"class":324},[318,700,336],{"class":335},[318,702,339],{"class":328},[318,704,705,707,709,711,713,715,717],{"class":320,"line":342},[318,706,325],{"class":324},[318,708,348],{"class":347},[318,710,351],{"class":324},[318,712,354],{"class":328},[318,714,332],{"class":324},[318,716,359],{"class":335},[318,718,339],{"class":328},[318,720,721,723,725,727,729,731,733],{"class":320,"line":364},[318,722,325],{"class":324},[318,724,348],{"class":347},[318,726,351],{"class":324},[318,728,373],{"class":328},[318,730,332],{"class":324},[318,732,378],{"class":335},[318,734,339],{"class":328},[318,736,737],{"class":320,"line":383},[318,738,387],{"emptyLinePlaceholder":386},[318,740,741],{"class":320,"line":390},[318,742,394],{"class":393},[318,744,745,747,750,752],{"class":320,"line":397},[318,746,400],{"class":324},[318,748,749],{"class":347}," stringToNumber",[318,751,406],{"class":324},[318,753,754],{"class":328}," z\n",[318,756,757,760,762],{"class":320,"line":419},[318,758,759],{"class":328},"  .",[318,761,425],{"class":412},[318,763,764],{"class":328},"()\n",[318,766,767,769,772,774,777,780,783,786,788,791,794],{"class":320,"line":443},[318,768,759],{"class":328},[318,770,771],{"class":412},"regex",[318,773,434],{"class":328},[318,775,776],{"class":335},"/",[318,778,779],{"class":324},"^",[318,781,782],{"class":347},"\\d",[318,784,785],{"class":324},"+$",[318,787,776],{"class":335},[318,789,790],{"class":328},", ",[318,792,793],{"class":335},"\"必须是数字字符串\"",[318,795,796],{"class":328},")\n",[318,798,799,801,804],{"class":320,"line":459},[318,800,759],{"class":328},[318,802,803],{"class":412},"transform",[318,805,806],{"class":328},"(Number);\n",[318,808,809,811,814,816,818,820],{"class":320,"line":465},[318,810,400],{"class":324},[318,812,813],{"class":347}," paginationSchema",[318,815,406],{"class":324},[318,817,409],{"class":328},[318,819,413],{"class":412},[318,821,416],{"class":328},[318,823,824,827,830,832,835,837,839],{"class":320,"line":471},[318,825,826],{"class":328},"  page: stringToNumber.",[318,828,829],{"class":412},"optional",[318,831,428],{"class":328},[318,833,834],{"class":412},"default",[318,836,434],{"class":328},[318,838,437],{"class":347},[318,840,440],{"class":328},[318,842,843,846,848,850,852,854,857],{"class":320,"line":487},[318,844,845],{"class":328},"  size: stringToNumber.",[318,847,829],{"class":412},[318,849,428],{"class":328},[318,851,834],{"class":412},[318,853,434],{"class":328},[318,855,856],{"class":347},"10",[318,858,440],{"class":328},[318,860,861],{"class":320,"line":510},[318,862,462],{"class":328},[318,864,865],{"class":320,"line":528},[318,866,387],{"emptyLinePlaceholder":386},[318,868,869],{"class":320,"line":533},[318,870,468],{"class":393},[318,872,873,875,877,879,881,883],{"class":320,"line":538},[318,874,400],{"class":324},[318,876,749],{"class":347},[318,878,406],{"class":324},[318,880,480],{"class":328},[318,882,493],{"class":412},[318,884,547],{"class":328},[318,886,887,890,892],{"class":320,"line":550},[318,888,889],{"class":328},"  v.",[318,891,425],{"class":412},[318,893,456],{"class":328},[318,895,896,898,900,902,904,906,908,910,912,914,916],{"class":320,"line":556},[318,897,889],{"class":328},[318,899,771],{"class":412},[318,901,434],{"class":328},[318,903,776],{"class":335},[318,905,779],{"class":324},[318,907,782],{"class":347},[318,909,785],{"class":324},[318,911,776],{"class":335},[318,913,790],{"class":328},[318,915,793],{"class":335},[318,917,440],{"class":328},[318,919,920,922,924],{"class":320,"line":565},[318,921,889],{"class":328},[318,923,803],{"class":412},[318,925,926],{"class":328},"(Number),\n",[318,928,929],{"class":320,"line":587},[318,930,648],{"class":328},[318,932,933,935,937,939,941,943],{"class":320,"line":607},[318,934,400],{"class":324},[318,936,813],{"class":347},[318,938,406],{"class":324},[318,940,480],{"class":328},[318,942,413],{"class":412},[318,944,416],{"class":328},[318,946,947,950,952,955,957],{"class":320,"line":639},[318,948,949],{"class":328},"  page: v.",[318,951,829],{"class":412},[318,953,954],{"class":328},"(stringToNumber, ",[318,956,437],{"class":347},[318,958,440],{"class":328},[318,960,961,964,966,968,970],{"class":320,"line":645},[318,962,963],{"class":328},"  size: v.",[318,965,829],{"class":412},[318,967,954],{"class":328},[318,969,856],{"class":347},[318,971,440],{"class":328},[318,973,975],{"class":320,"line":974},24,[318,976,462],{"class":328},[318,978,980],{"class":320,"line":979},25,[318,981,387],{"emptyLinePlaceholder":386},[318,983,985,988,990,992,995,997,999,1001,1003],{"class":320,"line":984},26,[318,986,987],{"class":328},"app.",[318,989,544],{"class":412},[318,991,434],{"class":328},[318,993,994],{"class":324},"async",[318,996,571],{"class":328},[318,998,575],{"class":574},[318,1000,578],{"class":328},[318,1002,581],{"class":324},[318,1004,584],{"class":328},[318,1006,1008,1011,1014,1016,1018,1021],{"class":320,"line":1007},27,[318,1009,1010],{"class":324},"  const",[318,1012,1013],{"class":347}," query",[318,1015,406],{"class":324},[318,1017,598],{"class":324},[318,1019,1020],{"class":412}," getValidatedQuery",[318,1022,1023],{"class":328},"(event, paginationSchema);\n",[318,1025,1027,1030,1033,1036,1038,1041,1044,1046,1048,1051,1054],{"class":320,"line":1026},28,[318,1028,1029],{"class":324},"  return",[318,1031,1032],{"class":335}," `您当前在第 ${",[318,1034,1035],{"class":328},"query",[318,1037,619],{"class":335},[318,1039,1040],{"class":328},"page",[318,1042,1043],{"class":335},"} 页，每页显示 ${",[318,1045,1035],{"class":328},[318,1047,619],{"class":335},[318,1049,1050],{"class":328},"size",[318,1052,1053],{"class":335},"} 条内容。`",[318,1055,339],{"class":328},[318,1057,1059],{"class":320,"line":1058},29,[318,1060,462],{"class":328},[191,1062,1063,1064,1066],{},"如您所见，相较于 ",[201,1065,227],{}," 示例，我们可以利用验证库对传入数据进行转换，例如这里把数字的字符串形式转换为真正的数字，这在内容分页等场景中非常有用。",[191,1068,1069,1070,655],{},"如果您向该事件处理程序发送一个有效请求，比如 ",[201,1071,1072],{},"/?page=2&size=20",[309,1074,1076],{"className":658,"code":1075,"language":660,"meta":314,"style":314},"您当前在第 2 页，每页显示 20 条内容。\n",[201,1077,1078],{"__ignoreMap":314},[318,1079,1080],{"class":320,"line":321},[318,1081,1075],{},[191,1083,669,1084,673],{},[201,1085,672],{},[295,1087,1088],{"id":1088},"验证请求体",[191,1090,300,1091,1093,1094,307],{},[201,1092,233],{}," 来验证请求体并获取结果，替代 ",[201,1095,203],{},[309,1097,1099],{"className":311,"code":1098,"language":313,"meta":314,"style":314},"import { readValidatedBody } from \"h3\";\nimport { z } from \"zod\";\nimport * as v from \"valibot\";\n\n// 使用 Zod 示例\nconst userSchema = z.object({\n  name: z.string().min(3).max(20),\n  age: z.number({ coerce: true }).positive().int(),\n});\n\n// 使用 Valibot 示例\nconst userSchema = v.object({\n  name: v.pipe(v.string(), v.minLength(3), v.maxLength(20)),\n  age: v.pipe(v.number(), v.integer(), v.minValue(0)),\n});\n\napp.use(async (event) => {\n  const body = await readValidatedBody(event, userSchema);\n  return `你好 ${body.name}！你今年 ${body.age} 岁。`;\n});\n",[201,1100,1101,1114,1127,1143,1147,1151,1166,1195,1222,1226,1230,1234,1248,1281,1309,1313,1317,1337,1354,1384],{"__ignoreMap":314},[318,1102,1103,1105,1108,1110,1112],{"class":320,"line":321},[318,1104,325],{"class":324},[318,1106,1107],{"class":328}," { readValidatedBody } ",[318,1109,332],{"class":324},[318,1111,336],{"class":335},[318,1113,339],{"class":328},[318,1115,1116,1118,1121,1123,1125],{"class":320,"line":342},[318,1117,325],{"class":324},[318,1119,1120],{"class":328}," { z } ",[318,1122,332],{"class":324},[318,1124,359],{"class":335},[318,1126,339],{"class":328},[318,1128,1129,1131,1133,1135,1137,1139,1141],{"class":320,"line":364},[318,1130,325],{"class":324},[318,1132,348],{"class":347},[318,1134,351],{"class":324},[318,1136,373],{"class":328},[318,1138,332],{"class":324},[318,1140,378],{"class":335},[318,1142,339],{"class":328},[318,1144,1145],{"class":320,"line":383},[318,1146,387],{"emptyLinePlaceholder":386},[318,1148,1149],{"class":320,"line":390},[318,1150,394],{"class":393},[318,1152,1153,1155,1158,1160,1162,1164],{"class":320,"line":397},[318,1154,400],{"class":324},[318,1156,1157],{"class":347}," userSchema",[318,1159,406],{"class":324},[318,1161,409],{"class":328},[318,1163,413],{"class":412},[318,1165,416],{"class":328},[318,1167,1168,1171,1173,1175,1177,1179,1182,1185,1188,1190,1193],{"class":320,"line":419},[318,1169,1170],{"class":328},"  name: z.",[318,1172,425],{"class":412},[318,1174,428],{"class":328},[318,1176,431],{"class":412},[318,1178,434],{"class":328},[318,1180,1181],{"class":347},"3",[318,1183,1184],{"class":328},").",[318,1186,1187],{"class":412},"max",[318,1189,434],{"class":328},[318,1191,1192],{"class":347},"20",[318,1194,440],{"class":328},[318,1196,1197,1200,1203,1206,1209,1212,1215,1217,1220],{"class":320,"line":443},[318,1198,1199],{"class":328},"  age: z.",[318,1201,1202],{"class":412},"number",[318,1204,1205],{"class":328},"({ coerce: ",[318,1207,1208],{"class":347},"true",[318,1210,1211],{"class":328}," }).",[318,1213,1214],{"class":412},"positive",[318,1216,428],{"class":328},[318,1218,1219],{"class":412},"int",[318,1221,456],{"class":328},[318,1223,1224],{"class":320,"line":459},[318,1225,462],{"class":328},[318,1227,1228],{"class":320,"line":465},[318,1229,387],{"emptyLinePlaceholder":386},[318,1231,1232],{"class":320,"line":471},[318,1233,468],{"class":393},[318,1235,1236,1238,1240,1242,1244,1246],{"class":320,"line":487},[318,1237,400],{"class":324},[318,1239,1157],{"class":347},[318,1241,406],{"class":324},[318,1243,480],{"class":328},[318,1245,413],{"class":412},[318,1247,416],{"class":328},[318,1249,1250,1253,1255,1257,1259,1261,1264,1266,1268,1271,1274,1276,1278],{"class":320,"line":510},[318,1251,1252],{"class":328},"  name: v.",[318,1254,493],{"class":412},[318,1256,496],{"class":328},[318,1258,425],{"class":412},[318,1260,501],{"class":328},[318,1262,1263],{"class":412},"minLength",[318,1265,434],{"class":328},[318,1267,1181],{"class":347},[318,1269,1270],{"class":328},"), v.",[318,1272,1273],{"class":412},"maxLength",[318,1275,434],{"class":328},[318,1277,1192],{"class":347},[318,1279,1280],{"class":328},")),\n",[318,1282,1283,1286,1288,1290,1292,1294,1297,1299,1302,1304,1307],{"class":320,"line":528},[318,1284,1285],{"class":328},"  age: v.",[318,1287,493],{"class":412},[318,1289,496],{"class":328},[318,1291,1202],{"class":412},[318,1293,501],{"class":328},[318,1295,1296],{"class":412},"integer",[318,1298,501],{"class":328},[318,1300,1301],{"class":412},"minValue",[318,1303,434],{"class":328},[318,1305,1306],{"class":347},"0",[318,1308,1280],{"class":328},[318,1310,1311],{"class":320,"line":533},[318,1312,462],{"class":328},[318,1314,1315],{"class":320,"line":538},[318,1316,387],{"emptyLinePlaceholder":386},[318,1318,1319,1321,1323,1325,1327,1329,1331,1333,1335],{"class":320,"line":550},[318,1320,987],{"class":328},[318,1322,544],{"class":412},[318,1324,434],{"class":328},[318,1326,994],{"class":324},[318,1328,571],{"class":328},[318,1330,575],{"class":574},[318,1332,578],{"class":328},[318,1334,581],{"class":324},[318,1336,584],{"class":328},[318,1338,1339,1341,1344,1346,1348,1351],{"class":320,"line":556},[318,1340,1010],{"class":324},[318,1342,1343],{"class":347}," body",[318,1345,406],{"class":324},[318,1347,598],{"class":324},[318,1349,1350],{"class":412}," readValidatedBody",[318,1352,1353],{"class":328},"(event, userSchema);\n",[318,1355,1356,1358,1361,1364,1366,1369,1372,1374,1376,1379,1382],{"class":320,"line":565},[318,1357,1029],{"class":324},[318,1359,1360],{"class":335}," `你好 ${",[318,1362,1363],{"class":328},"body",[318,1365,619],{"class":335},[318,1367,1368],{"class":328},"name",[318,1370,1371],{"class":335},"}！你今年 ${",[318,1373,1363],{"class":328},[318,1375,619],{"class":335},[318,1377,1378],{"class":328},"age",[318,1380,1381],{"class":335},"} 岁。`",[318,1383,339],{"class":328},[318,1385,1386],{"class":320,"line":587},[318,1387,462],{"class":328},[191,1389,1390],{},"如果您发送一个带有如下 JSON 请求体的有效 POST 请求：",[309,1392,1396],{"className":1393,"code":1394,"language":1395,"meta":314,"style":314},"language-json shiki shiki-themes github-light github-dark github-dark","{\n  \"name\": \"John\",\n  \"age\": 42\n}\n","json",[201,1397,1398,1403,1416,1426],{"__ignoreMap":314},[318,1399,1400],{"class":320,"line":321},[318,1401,1402],{"class":328},"{\n",[318,1404,1405,1408,1411,1414],{"class":320,"line":342},[318,1406,1407],{"class":347},"  \"name\"",[318,1409,1410],{"class":328},": ",[318,1412,1413],{"class":335},"\"John\"",[318,1415,562],{"class":328},[318,1417,1418,1421,1423],{"class":320,"line":364},[318,1419,1420],{"class":347},"  \"age\"",[318,1422,1410],{"class":328},[318,1424,1425],{"class":347},"42\n",[318,1427,1428],{"class":320,"line":383},[318,1429,1430],{"class":328},"}\n",[191,1432,1433],{},"您将得到如下响应：",[309,1435,1437],{"className":658,"code":1436,"language":660,"meta":314,"style":314},"你好 John！你今年 42 岁。\n",[201,1438,1439],{"__ignoreMap":314},[318,1440,1441],{"class":320,"line":321},[318,1442,1436],{},[191,1444,669,1445,673],{},[201,1446,672],{},[206,1448,271],{"id":271},[191,1450,1451,1452,250,1454,289,1456,1458,1459,1461],{},"默认情况下，如果直接将 schema 作为第二个参数传给任何验证辅助工具（",[201,1453,227],{},[201,1455,221],{},[201,1457,233],{},"），当验证失败时会抛出 ",[201,1460,672],{}," 错误。但在某些情况下，您可能想自己处理验证错误。这时，您应该根据所使用的验证库，传入其提供的实际安全验证函数作为第二个参数。",[191,1463,1464,1465,1467],{},"回到第一个示例中 ",[201,1466,227],{},"，对于 Zod 会是这样：",[309,1469,1473],{"className":1470,"code":1471,"language":1472,"meta":314,"style":314},"language-ts shiki shiki-themes github-light github-dark github-dark","import { getValidatedRouterParams } from \"h3\";\nimport { z } from \"zod/v4\";\n\nconst contentSchema = z.object({\n  topic: z.string().min(1),\n  uuid: z.string().uuid(),\n});\n\nrouter.use(\"/content/:topic/:uuid\", async (event) => {\n  const params = await getValidatedRouterParams(event, contentSchema.safeParse);\n  if (!params.success) {\n    // 处理验证错误\n    return `验证失败：\\n${z.prettifyError(params.error)}`;\n  }\n  return `您正在查找 topic 为 \"${params.data.topic}\" 且 uuid 为 \"${params.data.uuid}\" 的内容。`;\n});\n","ts",[201,1474,1475,1487,1500,1504,1518,1534,1546,1550,1554,1579,1594,1607,1612,1650,1655,1688],{"__ignoreMap":314},[318,1476,1477,1479,1481,1483,1485],{"class":320,"line":321},[318,1478,325],{"class":324},[318,1480,329],{"class":328},[318,1482,332],{"class":324},[318,1484,336],{"class":335},[318,1486,339],{"class":328},[318,1488,1489,1491,1493,1495,1498],{"class":320,"line":342},[318,1490,325],{"class":324},[318,1492,1120],{"class":328},[318,1494,332],{"class":324},[318,1496,1497],{"class":335}," \"zod/v4\"",[318,1499,339],{"class":328},[318,1501,1502],{"class":320,"line":364},[318,1503,387],{"emptyLinePlaceholder":386},[318,1505,1506,1508,1510,1512,1514,1516],{"class":320,"line":383},[318,1507,400],{"class":324},[318,1509,403],{"class":347},[318,1511,406],{"class":324},[318,1513,409],{"class":328},[318,1515,413],{"class":412},[318,1517,416],{"class":328},[318,1519,1520,1522,1524,1526,1528,1530,1532],{"class":320,"line":390},[318,1521,422],{"class":328},[318,1523,425],{"class":412},[318,1525,428],{"class":328},[318,1527,431],{"class":412},[318,1529,434],{"class":328},[318,1531,437],{"class":347},[318,1533,440],{"class":328},[318,1535,1536,1538,1540,1542,1544],{"class":320,"line":397},[318,1537,446],{"class":328},[318,1539,425],{"class":412},[318,1541,428],{"class":328},[318,1543,453],{"class":412},[318,1545,456],{"class":328},[318,1547,1548],{"class":320,"line":419},[318,1549,462],{"class":328},[318,1551,1552],{"class":320,"line":443},[318,1553,387],{"emptyLinePlaceholder":386},[318,1555,1556,1558,1560,1562,1565,1567,1569,1571,1573,1575,1577],{"class":320,"line":459},[318,1557,541],{"class":328},[318,1559,544],{"class":412},[318,1561,434],{"class":328},[318,1563,1564],{"class":335},"\"/content/:topic/:uuid\"",[318,1566,790],{"class":328},[318,1568,994],{"class":324},[318,1570,571],{"class":328},[318,1572,575],{"class":574},[318,1574,578],{"class":328},[318,1576,581],{"class":324},[318,1578,584],{"class":328},[318,1580,1581,1583,1585,1587,1589,1591],{"class":320,"line":465},[318,1582,1010],{"class":324},[318,1584,593],{"class":347},[318,1586,406],{"class":324},[318,1588,598],{"class":324},[318,1590,601],{"class":412},[318,1592,1593],{"class":328},"(event, contentSchema.safeParse);\n",[318,1595,1596,1599,1601,1604],{"class":320,"line":471},[318,1597,1598],{"class":324},"  if",[318,1600,571],{"class":328},[318,1602,1603],{"class":324},"!",[318,1605,1606],{"class":328},"params.success) {\n",[318,1608,1609],{"class":320,"line":487},[318,1610,1611],{"class":393},"    // 处理验证错误\n",[318,1613,1614,1616,1619,1622,1625,1628,1630,1633,1635,1637,1639,1642,1645,1648],{"class":320,"line":510},[318,1615,610],{"class":324},[318,1617,1618],{"class":335}," `验证失败：",[318,1620,1621],{"class":347},"\\n",[318,1623,1624],{"class":335},"${",[318,1626,1627],{"class":328},"z",[318,1629,619],{"class":335},[318,1631,1632],{"class":412},"prettifyError",[318,1634,434],{"class":335},[318,1636,616],{"class":328},[318,1638,619],{"class":335},[318,1640,1641],{"class":328},"error",[318,1643,1644],{"class":335},")",[318,1646,1647],{"class":335},"}`",[318,1649,339],{"class":328},[318,1651,1652],{"class":320,"line":528},[318,1653,1654],{"class":328},"  }\n",[318,1656,1657,1659,1661,1663,1665,1668,1670,1672,1674,1676,1678,1680,1682,1684,1686],{"class":320,"line":533},[318,1658,1029],{"class":324},[318,1660,613],{"class":335},[318,1662,616],{"class":328},[318,1664,619],{"class":335},[318,1666,1667],{"class":328},"data",[318,1669,619],{"class":335},[318,1671,622],{"class":328},[318,1673,625],{"class":335},[318,1675,616],{"class":328},[318,1677,619],{"class":335},[318,1679,1667],{"class":328},[318,1681,619],{"class":335},[318,1683,453],{"class":328},[318,1685,634],{"class":335},[318,1687,339],{"class":328},[318,1689,1690],{"class":320,"line":538},[318,1691,462],{"class":328},[191,1693,1694],{},"而对于 Valibot 则是这样：",[309,1696,1698],{"className":1470,"code":1697,"language":1472,"meta":314,"style":314},"import { getValidatedRouterParams } from \"h3\";\nimport * as v from \"valibot\";\n\nconst contentSchema = v.object({\n  topic: v.pipe(v.string(), v.nonEmpty()),\n  uuid: v.pipe(v.string(), v.uuid()),\n});\n\nrouter.use(\"/content/:topic/:uuid\", async (event) => {\n  const params = await getValidatedRouterParams(\n    event,\n    v.safeParser(contentSchema),\n  );\n  if (!params.success) {\n    // 处理验证错误\n    return `验证失败：\\n${v.summarize(params.issues)}`;\n  }\n  return `您正在查找 topic 为 \"${params.output.topic}\" 且 uuid 为 \"${params.output.uuid}\" 的内容。`;\n});\n",[201,1699,1700,1712,1728,1732,1746,1762,1778,1782,1786,1810,1824,1829,1840,1845,1855,1859,1892,1896,1929],{"__ignoreMap":314},[318,1701,1702,1704,1706,1708,1710],{"class":320,"line":321},[318,1703,325],{"class":324},[318,1705,329],{"class":328},[318,1707,332],{"class":324},[318,1709,336],{"class":335},[318,1711,339],{"class":328},[318,1713,1714,1716,1718,1720,1722,1724,1726],{"class":320,"line":342},[318,1715,325],{"class":324},[318,1717,348],{"class":347},[318,1719,351],{"class":324},[318,1721,373],{"class":328},[318,1723,332],{"class":324},[318,1725,378],{"class":335},[318,1727,339],{"class":328},[318,1729,1730],{"class":320,"line":364},[318,1731,387],{"emptyLinePlaceholder":386},[318,1733,1734,1736,1738,1740,1742,1744],{"class":320,"line":383},[318,1735,400],{"class":324},[318,1737,403],{"class":347},[318,1739,406],{"class":324},[318,1741,480],{"class":328},[318,1743,413],{"class":412},[318,1745,416],{"class":328},[318,1747,1748,1750,1752,1754,1756,1758,1760],{"class":320,"line":390},[318,1749,490],{"class":328},[318,1751,493],{"class":412},[318,1753,496],{"class":328},[318,1755,425],{"class":412},[318,1757,501],{"class":328},[318,1759,504],{"class":412},[318,1761,507],{"class":328},[318,1763,1764,1766,1768,1770,1772,1774,1776],{"class":320,"line":397},[318,1765,513],{"class":328},[318,1767,493],{"class":412},[318,1769,496],{"class":328},[318,1771,425],{"class":412},[318,1773,501],{"class":328},[318,1775,453],{"class":412},[318,1777,507],{"class":328},[318,1779,1780],{"class":320,"line":419},[318,1781,462],{"class":328},[318,1783,1784],{"class":320,"line":443},[318,1785,387],{"emptyLinePlaceholder":386},[318,1787,1788,1790,1792,1794,1796,1798,1800,1802,1804,1806,1808],{"class":320,"line":459},[318,1789,541],{"class":328},[318,1791,544],{"class":412},[318,1793,434],{"class":328},[318,1795,1564],{"class":335},[318,1797,790],{"class":328},[318,1799,994],{"class":324},[318,1801,571],{"class":328},[318,1803,575],{"class":574},[318,1805,578],{"class":328},[318,1807,581],{"class":324},[318,1809,584],{"class":328},[318,1811,1812,1814,1816,1818,1820,1822],{"class":320,"line":465},[318,1813,1010],{"class":324},[318,1815,593],{"class":347},[318,1817,406],{"class":324},[318,1819,598],{"class":324},[318,1821,601],{"class":412},[318,1823,547],{"class":328},[318,1825,1826],{"class":320,"line":471},[318,1827,1828],{"class":328},"    event,\n",[318,1830,1831,1834,1837],{"class":320,"line":487},[318,1832,1833],{"class":328},"    v.",[318,1835,1836],{"class":412},"safeParser",[318,1838,1839],{"class":328},"(contentSchema),\n",[318,1841,1842],{"class":320,"line":510},[318,1843,1844],{"class":328},"  );\n",[318,1846,1847,1849,1851,1853],{"class":320,"line":528},[318,1848,1598],{"class":324},[318,1850,571],{"class":328},[318,1852,1603],{"class":324},[318,1854,1606],{"class":328},[318,1856,1857],{"class":320,"line":533},[318,1858,1611],{"class":393},[318,1860,1861,1863,1865,1867,1869,1872,1874,1877,1879,1881,1883,1886,1888,1890],{"class":320,"line":538},[318,1862,610],{"class":324},[318,1864,1618],{"class":335},[318,1866,1621],{"class":347},[318,1868,1624],{"class":335},[318,1870,1871],{"class":328},"v",[318,1873,619],{"class":335},[318,1875,1876],{"class":412},"summarize",[318,1878,434],{"class":335},[318,1880,616],{"class":328},[318,1882,619],{"class":335},[318,1884,1885],{"class":328},"issues",[318,1887,1644],{"class":335},[318,1889,1647],{"class":335},[318,1891,339],{"class":328},[318,1893,1894],{"class":320,"line":550},[318,1895,1654],{"class":328},[318,1897,1898,1900,1902,1904,1906,1909,1911,1913,1915,1917,1919,1921,1923,1925,1927],{"class":320,"line":556},[318,1899,1029],{"class":324},[318,1901,613],{"class":335},[318,1903,616],{"class":328},[318,1905,619],{"class":335},[318,1907,1908],{"class":328},"output",[318,1910,619],{"class":335},[318,1912,622],{"class":328},[318,1914,625],{"class":335},[318,1916,616],{"class":328},[318,1918,619],{"class":335},[318,1920,1908],{"class":328},[318,1922,619],{"class":335},[318,1924,453],{"class":328},[318,1926,634],{"class":335},[318,1928,339],{"class":328},[318,1930,1931],{"class":320,"line":565},[318,1932,462],{"class":328},[1934,1935,1936],"style",{},"html pre.shiki code .so5gQ, html code.shiki .so5gQ{--shiki-light:#D73A49;--shiki-default:#F97583;--shiki-dark:#F97583}html pre.shiki code .slsVL, html code.shiki .slsVL{--shiki-light:#24292E;--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8}html pre.shiki code .sfrk1, html code.shiki .sfrk1{--shiki-light:#032F62;--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF}html pre.shiki code .suiK_, html code.shiki .suiK_{--shiki-light:#005CC5;--shiki-default:#79B8FF;--shiki-dark:#79B8FF}html pre.shiki code .sCsY4, html code.shiki .sCsY4{--shiki-light:#6A737D;--shiki-default:#6A737D;--shiki-dark:#6A737D}html pre.shiki code .shcOC, html code.shiki .shcOC{--shiki-light:#6F42C1;--shiki-default:#B392F0;--shiki-dark:#B392F0}html pre.shiki code .sQHwn, html code.shiki .sQHwn{--shiki-light:#E36209;--shiki-default:#FFAB70;--shiki-dark:#FFAB70}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":314,"searchDepth":342,"depth":342,"links":1938},[1939,1944],{"id":208,"depth":342,"text":208,"children":1940},[1941,1942,1943],{"id":297,"depth":364,"text":297},{"id":676,"depth":364,"text":676},{"id":1088,"depth":364,"text":1088},{"id":271,"depth":342,"text":271},"在处理数据之前，确保您的数据是有效且安全的。","md",{"icon":144},{"icon":144},{"title":158,"description":1945},"2rt7yFNlVtKObD1u9vLZMyBbhJjwtV5qD3tFG2qGv5o",[1952,1954],{"title":154,"path":155,"stem":156,"description":1953,"icon":144,"children":-1},"向客户端进行流式响应。",{"title":162,"path":163,"stem":164,"description":314,"icon":167,"children":-1},1762531024092]